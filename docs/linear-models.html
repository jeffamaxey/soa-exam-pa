<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Linear Models | Society of Actuaries Exam PA</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Linear Models | Society of Actuaries Exam PA" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="jeffamaxey/soa-exam-pa" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Linear Models | Society of Actuaries Exam PA" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Jeff A. Maxey" />


<meta name="date" content="2024-10-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-exploration-and-visualization.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="assets/css/style.css" type="text/css" />
<link rel="stylesheet" href="assets/css/toc.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Society of Actuaries Exam PA</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#getting-started"><i class="fa fa-check"></i>Getting Started</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html#system-requirements"><i class="fa fa-check"></i>System Requirements</a></li>
</ul></li>
<li class="part"><span><b>I A Crash Course in R</b></span></li>
<li class="chapter" data-level="1" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html"><i class="fa fa-check"></i><b>1</b> Basics of R Programming</a>
<ul>
<li class="chapter" data-level="1.1" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#data-types-in-r"><i class="fa fa-check"></i><b>1.1</b> Data Types in R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#exercise-1.2.2---calculating-least-squares-estimates-by-matrix-manipulation"><i class="fa fa-check"></i><b>1.1.1</b> Exercise 1.2.2 - Calculating least squares estimates by matrix manipulation</a></li>
<li class="chapter" data-level="1.1.2" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#data-frames"><i class="fa fa-check"></i><b>1.1.2</b> Data Frames</a></li>
<li class="chapter" data-level="1.1.3" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#exercise-1.2.3---listing-the-components-of-a-list"><i class="fa fa-check"></i><b>1.1.3</b> Exercise 1.2.3 - Listing the components of a list</a></li>
<li class="chapter" data-level="1.1.4" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#functions"><i class="fa fa-check"></i><b>1.1.4</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#basic-data-management"><i class="fa fa-check"></i><b>1.2</b> Basic Data Management</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#task-1-removing-unimportant-variables"><i class="fa fa-check"></i><b>1.2.1</b> Task 1: Removing Unimportant Variables</a></li>
<li class="chapter" data-level="1.2.2" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#task-2-missing-values"><i class="fa fa-check"></i><b>1.2.2</b> Task 2: Missing Values</a></li>
<li class="chapter" data-level="1.2.3" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#task-3-adding-new-variables"><i class="fa fa-check"></i><b>1.2.3</b> Task 3: Adding New Variables</a></li>
<li class="chapter" data-level="1.2.4" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#task-4-using-logical-tests-to-identify-observations-with-certain-characteristics"><i class="fa fa-check"></i><b>1.2.4</b> Task 4: Using Logical Tests to Identify Observations with Certain Characteristics</a></li>
<li class="chapter" data-level="1.2.5" data-path="basics-of-r-programming.html"><a href="basics-of-r-programming.html#end-of-chapter-1-practice-problems"><i class="fa fa-check"></i><b>1.2.5</b> End of Chapter 1 Practice Problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html"><i class="fa fa-check"></i><b>2</b> Data Exploration and Visualization</a>
<ul>
<li class="chapter" data-level="" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#chapter-02-overview"><i class="fa fa-check"></i>Chapter Overview</a></li>
<li class="chapter" data-level="2.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#chapter-02-making-ggplots"><i class="fa fa-check"></i><b>2.1</b> Making <code>ggplots</code></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#chapter-02-making-ggplots-basic-features"><i class="fa fa-check"></i><b>2.1.1</b> Basic Features</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#chapter-02-making-ggplots-customizing-your-plots"><i class="fa fa-check"></i><b>2.1.2</b> Customizing Your Plots</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#chapter-02-data-exploration"><i class="fa fa-check"></i><b>2.2</b> Data Exploration</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#chapter-02-data-exploration-univariate"><i class="fa fa-check"></i><b>2.2.1</b> Univariate Data Exploration</a></li>
<li class="chapter" data-level="2.2.2" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#chapter-02-data-exploration-bivariate"><i class="fa fa-check"></i><b>2.2.2</b> Bivariate Data Exploration</a></li>
<li class="chapter" data-level="2.2.3" data-path="data-exploration-and-visualization.html"><a href="data-exploration-and-visualization.html#end-of-chapter-practice-problems"><i class="fa fa-check"></i><b>2.2.3</b> End-of-Chapter Practice Problems</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Theory of and Case Studies in Predictive Analytics</b></span></li>
<li class="chapter" data-level="3" data-path="linear-models.html"><a href="linear-models.html"><i class="fa fa-check"></i><b>3</b> Linear Models</a>
<ul>
<li class="chapter" data-level="3.1" data-path="linear-models.html"><a href="linear-models.html#a-primer-on-predictive-analytics"><i class="fa fa-check"></i><b>3.1</b> A Primer on Predictive Analytics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="linear-models.html"><a href="linear-models.html#basic-terminology"><i class="fa fa-check"></i><b>3.1.1</b> Basic Terminology</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-models.html"><a href="linear-models.html#the-model-building-process"><i class="fa fa-check"></i><b>3.1.2</b> The Model Building Process</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-models.html"><a href="linear-models.html#bias-variance-trade-off"><i class="fa fa-check"></i><b>3.1.3</b> Bias-Variance Trade-Off</a></li>
<li class="chapter" data-level="3.1.4" data-path="linear-models.html"><a href="linear-models.html#feature-generation-and-selection"><i class="fa fa-check"></i><b>3.1.4</b> Feature Generation and Selection</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="linear-models.html"><a href="linear-models.html#linear-models-conceptual-foundation"><i class="fa fa-check"></i><b>3.2</b> Linear Models: Conceptual Foundation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="linear-models.html"><a href="linear-models.html#model-formulation"><i class="fa fa-check"></i><b>3.2.1</b> Model Formulation</a></li>
<li class="chapter" data-level="3.2.2" data-path="linear-models.html"><a href="linear-models.html#model-evaluation-and-validation"><i class="fa fa-check"></i><b>3.2.2</b> Model Evaluation and Validation</a></li>
<li class="chapter" data-level="3.2.3" data-path="linear-models.html"><a href="linear-models.html#feature-generation"><i class="fa fa-check"></i><b>3.2.3</b> Feature Generation</a></li>
<li class="chapter" data-level="3.2.4" data-path="linear-models.html"><a href="linear-models.html#feature-selection"><i class="fa fa-check"></i><b>3.2.4</b> Feature Selection</a></li>
<li class="chapter" data-level="3.2.5" data-path="linear-models.html"><a href="linear-models.html#regularization"><i class="fa fa-check"></i><b>3.2.5</b> Regularization</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="linear-models.html"><a href="linear-models.html#case-study-1-fitting-linear-models-in-r"><i class="fa fa-check"></i><b>3.3</b> Case Study 1: Fitting Linear Models in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="linear-models.html"><a href="linear-models.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>3.3.1</b> Exploratory Data Analysis</a></li>
<li class="chapter" data-level="3.3.2" data-path="linear-models.html"><a href="linear-models.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.3.2</b> Simple Linear Regression</a></li>
<li class="chapter" data-level="3.3.3" data-path="linear-models.html"><a href="linear-models.html#multiple-linear-regression"><i class="fa fa-check"></i><b>3.3.3</b> Multiple Linear Regression::::</a></li>
<li class="chapter" data-level="3.3.4" data-path="linear-models.html"><a href="linear-models.html#evaluation-of-linear-models"><i class="fa fa-check"></i><b>3.3.4</b> Evaluation of Linear Models</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="linear-models.html"><a href="linear-models.html#case-study-2-feature-selection-and-regularization"><i class="fa fa-check"></i><b>3.4</b> Case Study 2: Feature Selection and Regularization</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="linear-models.html"><a href="linear-models.html#preparatory-work"><i class="fa fa-check"></i><b>3.4.1</b> Preparatory Work</a></li>
<li class="chapter" data-level="3.4.2" data-path="linear-models.html"><a href="linear-models.html#model-construction-and-feature-selection"><i class="fa fa-check"></i><b>3.4.2</b> Model Construction and Feature Selection</a></li>
<li class="chapter" data-level="3.4.3" data-path="linear-models.html"><a href="linear-models.html#model-validation"><i class="fa fa-check"></i><b>3.4.3</b> Model Validation</a></li>
<li class="chapter" data-level="3.4.4" data-path="linear-models.html"><a href="linear-models.html#regularization-1"><i class="fa fa-check"></i><b>3.4.4</b> Regularization</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="linear-models.html"><a href="linear-models.html#conceptual-review-questions-for-chapter-3"><i class="fa fa-check"></i>Conceptual Review: Questions for Chapter 3</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/jeffamaxey/soa-exam-pa" target="blank">Github Repository</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Society of Actuaries Exam PA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-models" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Linear Models<a href="linear-models.html#linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="a-primer-on-predictive-analytics" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> A Primer on Predictive Analytics<a href="linear-models.html#a-primer-on-predictive-analytics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This subsection streamlines the material scattered in different parts of the PA modules (which are notoriously difficult to digest) and presents a coherent introduction to predictive analytics.</p>
<p>The fundamental concepts introduced in this section are universally applicable in the sense that they apply to essentially all types of models, and will be illustrated in the context of specific types of models (generalized linear models and decision trees, in particular) in this and later chapters.</p>
<div id="basic-terminology" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Basic Terminology<a href="linear-models.html#basic-terminology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Predictive Analytics in a Nutshell:</strong></p>
<p>What exactly is predictive analytics? To answer this question, it may help to understand the three main categories of predictive modeling problems suggested by the PA modules:</p>
<ul>
<li><strong>Descriptive:</strong> Descriptive analytics focuses on what happened in the <strong><em>past</em></strong> and aims to “describe” or explain the observed trends by identifying the relationships between different variables in the data.
<ul>
<li><strong>Example:</strong> If you saw an increase in the lapse rate among the policyholders of a certain line of business, what kind of policyholders had the highest tendency to lapse? This is a question that can be answered by descriptive analytics.</li>
</ul></li>
<li><strong>Predictive:</strong> Predictive analytics focuses on what will happen in the <strong><em>future</em></strong> and is concerned with making accurate “predictions”.
<ul>
<li><strong>Example:</strong> For a prospective policyholder with certain characteristics, what is their predicted probability of lapse? The ability to make such a prediction will be useful for identifying future policyholders who will have a lower probability of lapse and contribute to the profitability of an insurer.</li>
</ul></li>
<li><strong>Prescriptive:</strong> Prescriptive analytics uses a combination of optimization and simulation to investigate and quantify impact of different “prescribed” actions in different scenarios.
<ul>
<li><strong>Example:</strong> If we reduce the premium by a certain amount, how will this affect the lapse rate?</li>
</ul></li>
</ul>
<p>Not surprisingly, Exam PA is predominantly concerned with <em>predictive analytics</em>, although the three modeling approaches are often mutually complementary, not contradictory.</p>
<p>There is always an output (or outcome) of interest, which can be numeric (salary, premium, injury rates) or categorical (positive/negative, email/spam), and we have at our disposal a collection of input variables that may offer potentially useful information for predicting or understanding the output.</p>
<p>This “input-output” setting is characteristic of predictive analytics in general, and our job is to develop a model teasing out the (possibly complex, overlapping) contributions of inputs to the outputs.</p>
<p><strong>Classification of Variables:</strong></p>
<p>Predictive analytics requires data, often with a large number of observations and variables. Generally speaking, there are two ways to classify variables in a predictive analytics context: By their role in the study (intended use) or by their nature (characteristics).</p>
<ul>
<li><p><strong>By Role:</strong> The variable that we are interested in predicting is called the <strong><em>target variable</em></strong>, or simply the <strong><em>target</em></strong> <strong>(a.k.a response variable, dependent variable, output variable, outcome variable).</strong></p>
<p>Despite the target variable being our interest, in most situations we cannot change the target variable directly, but we have control over some associated variables which can be used to predict the target. These variables go by different names, such as <strong><em>predictors, explanatory variables, independent variables, input variables</em></strong>.</p>
<p>In an actuarial context, predictors are also known as risk factors or risk drivers. In the remainder of this manual and in Exam PA, we will mostly use the term “predictors” and “features” (to be defined in Subsection 3.1.4).</p>
<p>Throughout your study of predictive analytics, it is useful to think of a predictive model as the following functional relationship between the target variable <span class="math inline">\(Y\)</span> and the set of predictors <span class="math inline">\(X = (X_{1}, ..., X_{p})\)</span> (collected as a vector): <span class="math display">\[
        \begin{equation}
        Y_{i} = f(X_{i}) + \epsilon_{i} (\#eq:linear-relationship)
        \end{equation}
        \]</span> Where:</p>
<ul>
<li><p>The subscript <span class="math inline">\(i\)</span> signifies the <span class="math inline">\(i\)</span>th observation in your dataset, so <span class="math inline">\(Y_{i}\)</span> is the value of the target variable for the <span class="math inline">\(i\)</span>th observation and <span class="math inline">\(X_{i} = (X_{i1},..., X_{ip})\)</span> is the corresponding vector of predictor values.</p></li>
<li><p>The symbol <span class="math inline">\(f\)</span> is a fixed (non-random) but unknown real function connecting the predictors and the target variables. Without the subscript <span class="math inline">\(i\)</span> (it is <span class="math inline">\(f\)</span> rather than <span class="math inline">\(f_{i}\)</span>), the function applies to all observations in the data, hence “systematic”. Largely synonymous with the model, this function carries the systematic information that the predictors offer about the target variable, and allows us to differentiate, or discriminate, the observations of the target variable on the basis of those of the predictors.</p>
<p>Different types of predictive models are distinguished by the structural form of this function, e.g., linear for linear models and piece-wise constant for decision trees, as we will see in later chapters.</p></li>
<li><p>The symbol <span class="math inline">\(\epsilon_{i}\)</span> is a zero-mean random error term carrying information that is specific to the <span class="math inline">\(i\)</span>th observation, hence “idiosyncratic” and the presence of the subscript <span class="math inline">\(i\)</span>. It can be regarded as a catch-all for what the systematic component of the model misses, e.g., the true relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> is probably more complex than <a href="#eq:linear-relationship">(<strong>??</strong>)</a>, there are other variables associated with <span class="math inline">\(Y\)</span> omitted by the model.</p>
<p>Although <a href="#eq:linear-relationship">(<strong>??</strong>)</a> looks abstract and the exam will not test it directly, it will provide a useful framework for thinking about predictive analytics.</p>
<p>For convenience, we will refer to <span class="math inline">\(f\)</span> and <span class="math inline">\(\epsilon\)</span> respectively as the <span class="math inline">\(\fbox{signal function}\)</span> and the <span class="math inline">\(\fbox{noise}\)</span> which are engineering terms.</p>
<p>We are interested in the signal, but the data we have is “contaminated” with noise. The goal of predictive analytics is to filter out the noise and use a variety of tools and techniques to learn as much about the signal as possible from the data. This knowledge about the signal can then provide us with a basis for understanding the data-generating process underlying the population of interest, and making predictions for the target variable.</p></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p><strong>By Nature:</strong> Variables can also be classified as <em>numeric</em> variables or <em>categorical</em> variables. Such a classification has important implications for developing an effective predictive model that aligns with the character of the target variable and predictors to produce realistic output.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Numeric Variables:</strong> Numeric variables take the form of numbers with a well-defined order (e.g., 1 must be less than 2) and an associated range. They can be further classified as:</p>
<ul>
<li><p><strong>Discrete variables:</strong> Restricted to only certain numeric values in that range, e.g., non-negative integers.</p></li>
<li><p><strong>Continuous:</strong> Can assume any value in a continuum, at least in theory.</p></li>
</ul></li>
<li><p><strong>Categorical Variables:</strong> Categorical variables take predefined values in a countable collection of “categories”. These categories, which often have no numeric order (i.e., we cannot say which category is larger or smaller), are called the <strong>levels</strong> or <strong>classes</strong> of the variable. Here are some examples of properties that can be described by categorical variables:</p>
<ul>
<li><p>Gender (male, female, or non-binary)</p></li>
<li><p>Smoking status (smoking or non-smoking)</p></li>
<li><p>Risk group (preferred, standard, rated, or un-insurable)</p></li>
<li><p>Marital status (single, married, divorced, or widowed)</p></li>
</ul>
<p>An important special case of a categorical variable is a <strong>binary</strong> variable, which only takes two possible levels (often yes or no), indicating whether an event has taken place or whether a characteristic is present.</p>
<p>In many datasets in practice, categorical variables are represented by numbers, but note that coding the levels of a categorical variable by numbers does not make the variable numeric. Consider, for instance, the variable <span class="math inline">\(X\)</span> which represents smoking status and is encoded as: <span class="math display">\[
X = \begin{cases} &amp; \text{0, for a non-smoker,} \\ &amp; \text{1, for a smoker,} \\ &amp; \text{2, for an individual with unknown smoking status.}  \end{cases}
\]</span></p>
<p>Even though the three levels “non-smoker”, “smoker”, and “unknown” have been coded as “0”, “1”, and “2”, respectively, the three numbers are merely labels without an implicit order and cannot be compared in an algebraic fashion. For example, “1” is not less than “2” in a meaningful fashion in this case.</p></li>
</ol>
<p>In predictive modeling, the type of model to use is largely determined by the nature of the target variable, not the predictors.</p>
<p>In other words, the distinction between continuous and categorical variables is relatively unimportant when they serve as predictors of a model, but we need to take the distinction properly into account when they serve as the target variable. Some predictive models (e.g., linear models) will work well only for continuous target variables while some (e.g., generalized linear models and decision trees) apply to both numeric and categorical target variables.</p></li>
</ul>
<p><strong>Supervised vs. Unsupervised Problems:</strong></p>
<p>Predictive analytics problems can also be classified into <em>supervised</em> and <em>unsupervised</em> problems, depending on the presence of a target variable and the objective of analysis.</p>
<ul>
<li><p><strong>Supervised Learning Problems:</strong> They refer to those for which there is a target variable “supervising” or guiding our analysis, and our goal is to understand the relationship between the target variable and the predictors, and/or make accurate predictions for the target based on the predictors.</p>
<ul>
<li><p><strong>Types of Supervised Learning Methods:</strong></p>
<ul>
<li><p>Generalized Linear Models (GLMs)</p></li>
<li><p>Decision Trees</p></li>
</ul></li>
</ul></li>
<li><p><strong>Unsupervised Learning Problems:</strong> For unsupervised learning methods, there is no target variable supervising our analysis (we are therefore “unsupervised”), and we are interested in extracting relationships and structures between different variables in the data.</p>
<ul>
<li><p><strong>Types of Unsupervised Learning Methods:</strong></p>
<ul>
<li><p>Principal Components Analysis (PCA)</p></li>
<li><p>Cluster Analysis</p></li>
</ul></li>
</ul></li>
</ul>
<p>Note that supervised and unsupervised learning methods are sometimes used in conjunction with one another. As we will see in Chapter 6, unsupervised learning methods can be used for the purposes of data exploration and producing potentially useful features for predicting the target variable more accurately.</p>
<p><strong>Regression vs. Classification Problems:</strong></p>
<p>In predictive analytics, it is customary to refer to supervised learning problems with a numeric target variable as <strong><em>regression</em></strong> problems (an exception is logistic regression, for which the target variable is binary; see Chapter 4. In contrast, when the target variable is categorical in nature, we are dealing with <strong><em>classification</em></strong> problems. A predictive model for predicting a categorical target variable involves “classifying” its observations to a certain level and is aptly called a <em>classifier</em>.</p>
<p>Both regression and classification problems are of importance in predictive modeling in general. The two kinds of predictive analytics problems have their unique features and will covered in detail in Part II of this manual.</p>
</div>
<div id="the-model-building-process" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> The Model Building Process<a href="linear-models.html#the-model-building-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have a first taste of what predictive analytics is like, in this important and rather lengthy subsection we will walk through the main steps involved in the construction and evaluation of a predictive model.</p>
<p>In practice, model building typically requires a sequence of complex and inter-related decisions. The whole process is iterative and often more of an art than a science. The framework here is necessarily simplified and focuses on the most important steps in Exam PA, but is rich enough to show you what it takes to build a good model in real life.</p>
<div id="stage-1-problem-definition" class="section level4 hasAnchor" number="3.1.2.1">
<h4><span class="header-section-number">3.1.2.1</span> Stage 1: Problem Definition<a href="linear-models.html#stage-1-problem-definition" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first step in any model building exercise is to clearly formulate the business problems to which predictive analytics will be applied.</p>
<div id="characteristics-of-predictive-modeling-problems" class="section level5 unnumbered hasAnchor">
<h5>Characteristics of Predictive Modeling Problems<a href="linear-models.html#characteristics-of-predictive-modeling-problems" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Before we decide to apply predictive analytics to solve a business problem, we should ensure that it is indeed a problem that should be addressed by predictive modeling.</p>
<p>A conceptual exam task testing the syllabus learning outcome, “Describe the characteristics of predictive modeling problems.”, may ask:</p>
<p>Some common characteristics of predictive modeling problems include:</p>
<table>
<caption><span id="tab:unnamed-chunk-4">TABLE 3.1: </span>Characteristics of Predictive Modeling Problems</caption>
<thead>
<tr class="header">
<th align="left">Characteristic</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Issue</strong></td>
<td align="left">There is a clearly identified and defined business issue that needs to be addressed.</td>
</tr>
<tr class="even">
<td align="left"><strong>Questions</strong></td>
<td align="left">The issue can be addressed with a few well-defined questions (What data do we need? What is the target or outcome? What is the success criteria / how will the model performance be evaluated?)</td>
</tr>
<tr class="odd">
<td align="left"><strong>Data</strong></td>
<td align="left">Good and useful data is available for answering the questions above.</td>
</tr>
<tr class="even">
<td align="left"><strong>Impact</strong></td>
<td align="left">The predictions will likely drive actions or increase understanding.</td>
</tr>
<tr class="odd">
<td align="left"><strong>Better Solution</strong></td>
<td align="left">Predictive analytics likely produces a solution better than any existing approach.</td>
</tr>
<tr class="even">
<td align="left"><strong>Update</strong></td>
<td align="left">We can continue to monitor and update the models when new data becomes available.</td>
</tr>
</tbody>
</table>
<p>A typical predictive modeling problem will have most, but not necessarily all of these characteristics.</p>
</div>
<div id="problem-definition" class="section level5 unnumbered hasAnchor">
<h5>Problem Definition<a href="linear-models.html#problem-definition" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>After deciding to use predictive analytics to address the business issue of interest, we should define the problem as clearly as possible.</p>
<p>It is important to get to the root cause of the business issue and make it specific enough to be solvable.</p>
<p>The following strategies suggested can help us come up with a meaningful problem definition and give our project a higher chance of success:</p>
<ul>
<li><p><strong>Hypotheses:</strong> It is useful to use our prior knowledge of the business problem to ask questions and develop hypotheses that can prove or disprove in the course of our analytic work. Doing so helps us gain a clearer understanding of the business issue and guide our efforts in a clearly defined way. With the questions and hypotheses, we know where to focus on.</p></li>
<li><p><strong>KPI’s:</strong> We also need ways to assess the outcome by selecting appropriate key performance indicators (KPI’s), which will provide a quantitative basis to measure the success of the project. Naturally, these KPI’s should align with the overall business strategy as far as possible and show the client what key numbers will change as a result of your predictive analytic work.</p></li>
</ul>
</div>
<div id="constraints" class="section level5 unnumbered hasAnchor">
<h5>Constraints<a href="linear-models.html#constraints" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>As soon as we have defined the business problem clearly, it is important to evaluate the feasibility of solving the business problem and implementing the predictive analytic solution.</p>
<p>We want to make sure that the solutions we produce will work. Some considerations and constraints we should keep in ind when evaluating and prioritizing business problems include:</p>
<ul>
<li>The availability of easily accessible and high-quality data.</li>
<li>Implementation issues such as the presence of necessary IT infrastructure and technology to fit complex models efficiently, the timeline for completing the project, and the cost and effort required to maintain the selected model.</li>
</ul>
<p>Do we have the resources to implement complex models without freezing or crashing? If a model is operationally prohibitive to execute, then it makes sense to trade some prediction performance for ease of implementation. After all, if we cannot actually implement and apply the model in practice, then it is basically useless.</p>
</div>
</div>
<div id="stage-2-data-collection-and-validation" class="section level4 hasAnchor" number="3.1.2.2">
<h4><span class="header-section-number">3.1.2.2</span> Stage 2: Data Collection and Validation<a href="linear-models.html#stage-2-data-collection-and-validation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Predictive analytics relies on models, which in turn are constructed from data. After defining the business problem properly, we will spend some time and effort collecting useful data that will underlie the predictive models we are going to build.</p>
<p>This data collection stage is more important and intricate than you probably first thought. You may have heard of the phrase “garbage in, garbage out”, better known as GIGO, which means that low-quality data is doomed to produce low-quality output.</p>
<p>Here we will learn some key considerations and some pitfalls to avoid related to the collection and use of data.</p>
<div id="data-design" class="section level5 unnumbered hasAnchor">
<h5>Data Design<a href="linear-models.html#data-design" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To begin, we will contemplate here to collect the data to be used in the modeling stage.</p>
<p>At the data design stage, there are a few things we should take note of to maximize the usefulness of our data source, which is the entire set of observations that enter the dataset you collect.</p>
<ul>
<li><p><strong>Relevance:</strong> Intuitively, the more data we have, the more information available and the better, provided that the data is unbiased (e.g., representative of the environment where our predictive model will operate). To ensure that the data is relevant for our business problem, it is necessary to source the data from the right population and time frame.</p>
<ul>
<li><p><strong>Population:</strong> As obvious as this may seem, it is important that the data source aligns with the true population we are interested in. If the data source is not a reasonably good proxy of a representative sample, then taking a larger dataset does not help, we are only representing the bias over again and again.</p></li>
<li><p><strong>Time Frame:</strong> When selecting an appropriate time frame for our data, it is advisable to choose the time period which best reflects the business environment in which we will be implementing our models. In general, recent history is more predictive of the near future than distant history, so data one year ago should be more useful than data 10 years ago, other things equal.</p></li>
</ul>
<p><strong>Example 3.1.1: Problems with a Facebook Poll</strong></p>
<p>In November 2020, the Divide States of America (DSA) held its 60th presidential election, with Donald Dump running against Joe Hidden. To gauge public sentiments towards the election, Great News Network (GNN), a/an information outlet, set up a poll on Facebook allowing users to vote for their preferred presidential candidate. Any Facebook users could take part in the poll, which was open between August 2020 and September 2020.</p>
<p>Evaluate the quality of the data collected by GNN with respect to the population, time frame, and/or other items.</p>
<p><strong><em>Solution:</em></strong> There are quite a few problems with the data collected by GNN, some of which are:</p>
<ul>
<li><p><strong>Population:</strong> The votes were limited to Facebook users while the intended audience was supposed to be all eligible citizens of DSA. Users of social media outlets tend to be younger generations, so there may be a systematic mismatch between the voters of the poll and the general population.</p></li>
<li><p><strong>Time Frame:</strong> The objective of the poll was to understand voters’ preferences at the time of the November 2020 election. The poll, conducted between August 2020 and September 2020, was premature in a way and might fail to gauge public sentiments accurately (a lot could happen in October). It may be desirable for the poll to extend to October, right before the November election took place.</p></li>
<li><p><strong>Quality:</strong> By design, the data collected is susceptible to <strong><em>contamination</em></strong>. An individual may register for several accounts and take part in the poll several times. The repetitive votes are allowed by the poll could substantially bias the polling results.</p></li>
</ul>
<p><strong>Example 3.1.2 Considerations with Time Frame (Based on Exercise 2.1.1 in the PA Modules)</strong></p>
<p>Suppose that you are constructing a model to predict which retirement option a customer will choose. You have data from 1990 to 2020 containing your customers choices. In 2010, your company introduced a digital platform, which increased not only the variety of retirement options available, but also the richness of the supporting data available to customers when they made their decisions.</p>
<p>Discuss the pros and cons of including all of the data from 1990 relative to including only the data from 2010 for constructing your predictive model.</p>
<p><strong><em>Solution:</em></strong></p>
<ul>
<li><p><strong>Pros:</strong> Including all of the data from 1990 means more data. Other things equal, having more data is generally desirable as it makes model training more robust and less vulnerable to noise.</p></li>
<li><p><strong>Cons:</strong> In predictive modeling, it is important to select the period of time that best reflects the environment in which we will be implementing our model. In this case, something happened in 2010 which significantly affected the behavior of the outcome (retirement options) we are modeling. This makes the data prior to 2010 less likely to be predictive of current and future behavior of customers. Including such (outdated) data may make the predictions of retirement options in the current era less accurate.</p></li>
</ul></li>
<li><p><strong>Sampling:</strong> Sampling is the process of taking a subset of observations from the data source to generate our dataset.</p>
<p>Why do we need to bother with sampling? Why not use the entire data source? In reality, the underlying population is often too big to handle, and we need a smaller, much more manageable subset to form our data.</p>
<p>The observations sampled should closely resemble the business environment in which our predictive model will be applied in the future. In fact, a good time frame, discussed above, can be seen as a form of sampling, which the same goal of making sure that our data is representative.</p>
<p>There are a number of sampling methods commonly used to draw an appropriate sample:</p>
<ul>
<li><p><strong>Random Sampling:</strong> This is the simplest sampling scheme by which we “randomly” draw observations from the underlying population without replacement until we have the required number of observations. Each record is equally likely to be sampled.</p>
<ul>
<li><p>One common way to achieve <strong>random sampling</strong> is through a survey or questionnaire. Individuals in the population are invited to respond to the survey and contribute to the collected dataset.</p>
<p>However, voluntary surveys are known to be vulnerable to <strong><em>respondent bias</em></strong>. Only those interested will respond, which means that the respondents of a survey may make up a population different from the the population of interest.</p>
<p>For example, university students who respond to end-of-semester course evaluations tend to be those who feel strongly about the courses they take. These students with strong opinions may substantially bias the results of the course evaluations which are supposed to be for the general students.</p>
<p>Surveys also tend to suffer from a <strong><em>low response rate</em></strong>, unless there are financial incentives for people to respond.</p></li>
</ul></li>
<li><p><strong>Stratified Sampling:</strong> Stratified sampling involves dividing the underlying population into a number of non-overlapping “strata” or groups in a non-random fashion, and randomly sampling (with or without replacement) a set number of observations from each stratum.</p>
<p>This sampling method has the notable advantage of ensuring that every stratum is properly represented in the collected data. In Exam PA, the strata are usually formed with respect to the distribution of the target variable.</p>
<p>Here are a few special cases of <strong>stratified sampling</strong>:</p>
<ul>
<li><p><strong><em>Oversampling and Undersampling:</em></strong> These are sampling methods designed specifically for unbalanced data, and we will learn about them in detail in Subsection 4.1.4.</p></li>
<li><p><strong>Systematic Sampling:</strong> By systematic sampling, we draw observations according to a set pattern and there is no random mechanism controlling which observations are sampled.</p>
<p>For a population with 100,000 units, we may order them in a well-defined way and sample every tenth observation to get a smaller, more manageable sample of 10,000 units. Once the sampling rule has been set, the sampled observations are pre-determined.</p></li>
</ul></li>
</ul></li>
<li><p><strong>Granularity:</strong> Granularity refers to how precisely a variable in a dataset is measured, or equivalently, how detailed the information contained by the variable is. As an example, location, in ascending order of granularity, can be recorded in different degrees of precision:</p>
<ul>
<li><p>By Country (least granular)</p></li>
<li><p>By State</p></li>
<li><p>By City</p></li>
<li><p>By Zip Code</p></li>
<li><p>By Address (most granular)</p></li>
</ul>
<p>From country to address, we have more and more specific information about the location of an individual.</p>
<p>At the data design stage, it is a good idea to use a relatively high level of granularity. It is always possible to go from a higher level of granularity to a lower level of granularity down the track, but not the other way around.</p></li>
</ul>
</div>
<div id="data-quality-issues" class="section level5 unnumbered hasAnchor">
<h5>Data Quality Issues<a href="linear-models.html#data-quality-issues" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Once we have collected the data from a data source representative of the population of interest using an appropriate sampling method, we have to take an important step before jumping straight into doing predictive modeling: <strong><em>Data Validation</em></strong>, the process of ensuring the quality and appropriateness of the data available.</p>
<p>If the collected data falls short of our standards, we may have to go back to the data collection step and search for an alternative dataset.</p>
<ul>
<li><p><strong>Reasonableness:</strong> For a dataset to be useful, the data values should, at a minimum, be reasonable, which can be checked by exploratory data analysis. Do the key statistics for the variables make sense in the context of the business problem? If one of the variables is income and one observation has a negative income, then almost certainly this is a recording error that should be fixed before we launch into model construction.</p></li>
<li><p><strong>Consistency:</strong> We also need to ensure that the records in the data are inputted consistently, meaning that the same basis and rules have been applied to all values, so that they can be directly compared with one another.</p>
<ul>
<li><strong><em>Numeric Variables:</em></strong> For numeric variables, the same unit should be used across all rows of the data for consistency. If one of the variables is weight, the nits values should be measured either all in kilograms or all in pounds. If there is a monetary variable, such as income, then the same currency should be used throughout.</li>
</ul></li>
<li><p><strong><em>Categorical Variables:</em></strong> We should make sure that the factor levels of categorical variables are defined and recorded consistently over time with no coding changes, like either the full name (e.g., Iowa) or the two-character abbreviation (e.g., IA) for the state of policy issue.</p></li>
</ul>
<pre><code>To check consistency, it is necessary to gain knowledge of how the data entries are recorded. To this end, the data dictionary (see the next point) that accompanies each PA exam project will be useful.

If we want to combine multiple datasets to form new variables (columns) or new observations (rows), then the consistency checks above extend to all constituent datasets to make sure that the concatenation works properly.

If we need to join datasets by a certain variable (column), it is especially important to ensure that the format of that variable is consistent across both datasets to ease matching, e.g., name should be recorded either as [first name] or [last name], [first name] so that each person can be identified uniquely. The possible existence of a middle name adds further complication.</code></pre>
<!-- -->
<ul>
<li><p><strong>Sufficient Documentation:</strong> A good dataset should also be sufficiently documented so that other users can easily gain an accurate understanding of different aspects of the data. The PA modules suggest that effective documentation should at least include the following information:</p></li>
<li><p>A description of the dataset overall, including the data source (how and when the dataset was collected).</p></li>
<li><p>A description of each variable in the data, including its name, definition, and format (range of values for numeric variables and the possible levels for categorical variables).</p></li>
<li><p>Notes about any past updates or other irregularities of the dataset.</p></li>
<li><p>A statement of accountability for the correctness of the dataset.</p></li>
<li><p>A description of the governance processes used to manage the dataset.</p></li>
</ul>
<p>Exam PA exam project describes the dataset in the “Business Problem” section and provides you with a <em>data dictionary</em>, which lists all the variables in the data together with their information. Here is a sample data dictionary for a hypothetical group of insurance policies:</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-5">TABLE 3.2: </span>Sample Data Dictionary
</caption>
<thead>
<tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
VariableName
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Description
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
Values
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>age</code>
</td>
<td style="text-align:left;">
The age of a policyholder
</td>
<td style="text-align:left;">
Integer, 20 to 65
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>gender</code>
</td>
<td style="text-align:left;">
The gender of a policyholder
</td>
<td style="text-align:left;">
3 levels, “F”, “M”, and “0”
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>type</code>
</td>
<td style="text-align:left;">
The risk type of a policyholder
</td>
<td style="text-align:left;">
2 levels, “standard” and “substandard”
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>n_claims</code>
</td>
<td style="text-align:left;">
The number of claims submitted
</td>
<td style="text-align:left;">
Integer, 0 to 10
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>claims</code>
</td>
<td style="text-align:left;">
The total amount of claims
</td>
<td style="text-align:left;">
Numeric, 0 to 30,451.8
</td>
</tr>
</tbody>
</table>
</div>
<div id="other-data-issues" class="section level5 unnumbered hasAnchor">
<h5>Other Data Issues<a href="linear-models.html#other-data-issues" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Even if a dataset is representative of the population of interest and is of sufficient quality, there are additional regulatory and practical issues related to the collection and use of data that we need to be aware of.</p>
<ul>
<li><p><strong><em>PII</em></strong>: It is not uncommon that datasets contain personally identifiable information (PII). Examples of such include name, Social Security number, address, photographs and bio-metric needs.</p>
<ul>
<li>Anonymous: Needs to comply with the pertinent laws since processing of data is still required.</li>
<li>Data Security: Ensure that personal data receives sufficient protection such as encryption and access restrictions</li>
<li>Terms of Use: Be well aware of all terms and conditions and the privacy policy related to the collection and use of data.</li>
</ul></li>
<li><p><strong>Variables with Legal/Ethical Concerns</strong>: Race, Gender, Ethnicity, Age, Income, Disability Status may be controversial variables that are a part of the dataset, and differential treatment based on these variables may lead to unfair “discrimination” and regulation violations.</p>
<p>Proxies of Prohibited is occupation, which can be strongly correlated with gender, and coal mine workers. If we use occupation as a predictor, then even though we are not feeding gender directly into our model, we are still using the information about the gender indirectly.</p></li>
<li><p><strong>Target Leakeage</strong>: In predictive modeling, target leakage refers to the phenomenon that some predictors in a model include (“leak”) information about the target variable <strong><em>that will not be available when the model is applied in practice</em></strong>. These predictors are typically strongly associated with the target variable, but their values are not known until or after the target variable is observed. Remember that our aim when doing predictive analytics is to use the other variables to predict the target variable <strong><em>before</em></strong> it is observed, so these “predictors” cannot serve as predictors in reality. If we include these variables in the model construction process, then our model will appear to perform extraordinarily well.</p>
<p>Examples of Target Leakage:</p>
<ul>
<li><p>Suppose you are interest in predicting whether or not a policyholder of an insurance policy will incur a loss or not in a future period (binary target variable). If the number of incurred losses is one of the predictors you use, then it appears that you will be able to make the perfect predictions: <em><strong>By definition, an incurred loss must have arisen if the number of incurred losses is one or more</strong>. The number of incurred losses simply would not be available at the time we predict the occurrence of incurred losses in practice.</em></p></li>
<li><p>An extreme form of target leakage that is commonly tested on the exam is when the target variable itself is included as a predictor, or is used to develop new variables (e.g., principal components) for predicting the same target variable.</p>
<p>Exercise 3.1.7. *&amp; (Detecting target leakage) Consider the persinj dataset in Chapter 2 again, and treat amt as the target variable. The data dictionary is reproduced below:</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>amt</code></td>
<td>Settled claim amount (continuous numeric variable)</td>
</tr>
<tr class="even">
<td><code>inj</code></td>
<td>Injury code, with seven levels: 1 (no injury), 2, 3, 4, 5, 6 (fatal), 9 (not recorded).</td>
</tr>
<tr class="odd">
<td><code>legrep</code></td>
<td>legal representation (0 = no, 1 = yes)</td>
</tr>
<tr class="even">
<td><code>op_time</code></td>
<td>Operational time (standardized amount of time elapsed between the when the injury was reported and the time when the claim was settled)</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: decimal">
<li>Identify a variable in the dataset that may pose the problem of target leakage.</li>
<li>Suggest how to retain the variable in part (a) for constructing meaningful predictive models for amt.</li>
</ol>
<p><strong>Solution.</strong></p>
<ol style="list-style-type: decimal">
<li>The <code>op_time</code> variable may pose the problem of target leakage when amt is the target variable. According to the data dictionary, the value of op_time would not be known until a claim was settled, at which time the value of amt would be observed. Due to this timing issue, <code>op_time</code> ma not serve as a predictor of <code>amt</code> in practice.</li>
<li>We can first build a predictive model for <code>op_time</code> based on the variables other than <code>amt</code> and then use a separate predictive model to predict the <code>amt</code> based on the predicted value of <code>op_time</code> and/or other variables.</li>
</ol></li>
</ul></li>
</ul>
</div>
</div>
<div id="stage-3-exploratory-data-analysis" class="section level4 hasAnchor" number="3.1.2.3">
<h4><span class="header-section-number">3.1.2.3</span> Stage 3: Exploratory Data Analysis<a href="linear-models.html#stage-3-exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>After we have collected and validated the data, the next step is to perform <strong>Exploratory Data Analysis</strong>, which was discussed in Section @ref(2.2) with a focus on R programming and will further be illustrated in the case studies sections in the later part of this manual. The goals of exploratory data analysis are the same as those presented in Section @ref(2.2):</p>
<dl>
<dt><strong>Exploratory Data Analysis</strong></dt>
<dd>
<p>With the use of descriptive statistics and graphical displays, clean the data for incorrect, unreasonable, and inconsistent entries, and understand the characteristics of and the key relationships among variables in the data.</p>
<p>The observations we make may suggest an appropriate type of predictive model to use (e.g., GLMs vs. Decision Trees) and the best form for the predictors to enter the model.</p>
</dd>
</dl>
</div>
<div id="stage-4-model-construction-evaluation-and-selection-important" class="section level4 hasAnchor" number="3.1.2.4">
<h4><span class="header-section-number">3.1.2.4</span> Stage 4: Model Construction, Evaluation, and Selection [IMPORTANT!]<a href="linear-models.html#stage-4-model-construction-evaluation-and-selection-important" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Having defined the problem, collected some useful data, and taken a first look at the key variables, it is time for us to move onto the modelling phase and construct our predictive models in earnest.</p>
<div id="should-we-use-all-available-data-to-train-our-models" class="section level5 hasAnchor" number="3.1.2.4.1">
<h5><span class="header-section-number">3.1.2.4.1</span> <strong>Should we use all available data to train our models?</strong><a href="linear-models.html#should-we-use-all-available-data-to-train-our-models" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>You may be tempted to fit your predictive models directly to the whole set of data. Remember that one of the main goals when doing predictive modeling is to construct models that make good predictions. The fundamental question is is:</p>
<p>How do we go about designing a predictive model that performs well when it is applied to <strong><em>new, previously unseen</em></strong> data? In other words, how do we make sure that the model calibrated on <strong><em>past</em></strong> data excels in predicting <strong><em>future</em></strong> target values on the basis of <strong><em>future</em></strong> predictor values?</p>
<p>If we use all of the collected data for model fitting, that will leave no independent data for assessing the prediction performance of our models. It does not help much to evaluate the models on the same data on which they were built. After all, the models have seen those data and are not making genuine predictions. To ensure that our predictive models do a good job of describing the past data they have seen and, more importantly, prediction new, <em>future</em> observations, we need an unconventional way of leveraging our available data.</p>
</div>
<div id="training-test-set-split" class="section level5 hasAnchor" number="3.1.2.4.2">
<h5><span class="header-section-number">3.1.2.4.2</span> <strong>Training / Test Set Split</strong><a href="linear-models.html#training-test-set-split" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To construct a model that thrives on future data, it is common practice in predictive analytics to partition our data into a few parts, each of which plays a different role in the model development and evaluation process.</p>
<p>The simplest way is to split the full data into two parts, the training set and the test set; see Figure <a href="#fig:figure-schematic-diagram"><strong>??</strong></a> for a schematic diagram.</p>
<div class="float" id="figure-schematic-diagram">
<img src="assets/images/figure-3-1-1.jpeg" alt="Figure 3.1.1: A schematic diagram of the training / test set split." />
<div class="figcaption"><strong>Figure 3.1.1:</strong> A schematic diagram of the training / test set split.</div>
</div>
<dl>
<dt><strong>Training Set</strong></dt>
<dd>
<p>The larger part of the full data (70-80%), the <em>training set</em>, or <em>training data</em>, is where you “train”, fit, or develop your predictive model to estimate the signal function <span class="math inline">\(f\)</span> and, if needed, the model parameters.</p>
<p>The training is typically done by optimizing a certain objective function that describes how well the model matches the training observations. The fitted model is denoted by <span class="math inline">\(\hat{f}\)</span> , where the hat emphasizes that it is an estimate of <span class="math inline">\(f\)</span>. After the model has been trained, it is ready for making predictions on the other part of the full data.</p>
</dd>
<dt><strong>Test Set</strong></dt>
<dd>
<p>Following the fitting, you will apply the trained model to make a prediction for each observation in the <em>test set</em>, or <em>test data</em>, and assess the prediction performance of the model according to certain performance metrics.</p>
<p>Observations in the test set <u><strong>did not participate in the model training process</strong></u> and will provide a much more objective ground for evaluating prediction performance when the model is applied to new, future data.</p>
<p>In contrast, evaluating the model on the training set will give an overly optimistic and somewhat misleading picture of its true predictive performance – the model has already seen the training observations and is merely fitting, not predicting those observations.</p>
</dd>
</dl>
<p><strong>How to Split the Data?</strong></p>
<p>There are many ways to do the training/test split.</p>
<ul>
<li>It can be done <strong><em>purely randomly</em></strong> according to pre-specified proportions,</li>
<li>Using special <strong><em>statistical techniques</em></strong> that ensure the distributions of the target variable in the two sets are comparable (stratified sampling).</li>
<li>If one of the variables is a <strong><em>time-variable</em></strong>, such as calendar year or month, and the behavior of the target variable over time is of interest, then one more way to make the split is on the basis of time, allocating older observations to the training set, and the more recent observations to the test set. Such “out-of-time” validation is conducted often for time series data, also known as longitudinal data, and is use for evaluating how well a model extrapolates time trends observed in the past to future periods.</li>
</ul>
<p><strong>How many observations should we assign to the two sets?</strong></p>
<p>The relative size of the training and test sets involves a trade-off:</p>
<ul>
<li>Having more training data will make for a more robust predictive model more capable of learning the patterns in the data and less susceptible to noise.</li>
<li>If too little data is set aside for the test set, however, the assessment of the prediction performance of the trained model on new, unseen observations will be less reliable.</li>
</ul>
<p><strong>How to use the training/test set split to rank competing models?</strong></p>
<p>If we have multiple candidate models, then we can perform the following steps:</p>
<ol style="list-style-type: decimal">
<li>Split the data into training / test sets..
<ul>
<li>The same training and test sets should be used across all candidate models.</li>
</ul></li>
<li>Fit the models to the training set.</li>
<li>Evaluate the quality of these models on the test set; and</li>
<li>Choose the one with the best test set performance according to a certain model selection criterion.</li>
</ol>
<p>When the “test set” above is for <em>selecting</em> the best model and is more commonly referred to as the <strong><em>validation set</em></strong>.</p>
<dl>
<dt><strong>Test /Validation Set</strong></dt>
<dd>
<p>In many predictive modeling textbooks, the test set is where we obtain an independent measure of the prediction performance of your <strong><em>chosen model</em></strong> <strong>when</strong> it is applied to data not involved in training or <strong><em>selecting</em></strong> the final model. The test set is held out until the end.</p>
<p>The usage in this manual conforms to what you will likely see in PA exam projects, where we are more concerned with finding the best predictive model and less with exactly how well it performs on independent data. There is usually no independent test data set aside for final evaluation.</p>
</dd>
</dl>
</div>
<div id="common-performance-metrics" class="section level5 hasAnchor" number="3.1.2.4.3">
<h5><span class="header-section-number">3.1.2.4.3</span> Common Performance Metrics<a href="linear-models.html#common-performance-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="theorem">
<p><span id="thm:unlabeled-div-2" class="theorem"><strong>Theorem 3.1  </strong></span>For a right triangle, if <span class="math inline">\(c\)</span> denotes the length of the hypotenuse and <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> denotes the length of the other two sides, we have</p>
<p><span class="math display">\[a^2 + b^2 = c^2\]</span></p>
</div>
</div>
</div>
<div id="stage-5-model-validation" class="section level4 hasAnchor" number="3.1.2.5">
<h4><span class="header-section-number">3.1.2.5</span> Stage 5: Model Validation<a href="linear-models.html#stage-5-model-validation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
<div id="stage-6-model-maintenance" class="section level4 hasAnchor" number="3.1.2.6">
<h4><span class="header-section-number">3.1.2.6</span> Stage 6: Model Maintenance<a href="linear-models.html#stage-6-model-maintenance" class="anchor-section" aria-label="Anchor link to header"></a></h4>
</div>
</div>
<div id="bias-variance-trade-off" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Bias-Variance Trade-Off<a href="linear-models.html#bias-variance-trade-off" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="feature-generation-and-selection" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> Feature Generation and Selection<a href="linear-models.html#feature-generation-and-selection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="linear-models-conceptual-foundation" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Linear Models: Conceptual Foundation<a href="linear-models.html#linear-models-conceptual-foundation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="model-formulation" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Model Formulation<a href="linear-models.html#model-formulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="model-evaluation-and-validation" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Model Evaluation and Validation<a href="linear-models.html#model-evaluation-and-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="feature-generation" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Feature Generation<a href="linear-models.html#feature-generation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="feature-selection" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Feature Selection<a href="linear-models.html#feature-selection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="regularization" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Regularization<a href="linear-models.html#regularization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="case-study-1-fitting-linear-models-in-r" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Case Study 1: Fitting Linear Models in R<a href="linear-models.html#case-study-1-fitting-linear-models-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="exploratory-data-analysis" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Exploratory Data Analysis<a href="linear-models.html#exploratory-data-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="simple-linear-regression" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Simple Linear Regression<a href="linear-models.html#simple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="multiple-linear-regression" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Multiple Linear Regression::::<a href="linear-models.html#multiple-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="evaluation-of-linear-models" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Evaluation of Linear Models<a href="linear-models.html#evaluation-of-linear-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="case-study-2-feature-selection-and-regularization" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Case Study 2: Feature Selection and Regularization<a href="linear-models.html#case-study-2-feature-selection-and-regularization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="preparatory-work" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Preparatory Work<a href="linear-models.html#preparatory-work" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="model-construction-and-feature-selection" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Model Construction and Feature Selection<a href="linear-models.html#model-construction-and-feature-selection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="model-validation" class="section level3 hasAnchor" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> Model Validation<a href="linear-models.html#model-validation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="regularization-1" class="section level3 hasAnchor" number="3.4.4">
<h3><span class="header-section-number">3.4.4</span> Regularization<a href="linear-models.html#regularization-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="conceptual-review-questions-for-chapter-3" class="section level2 unnumbered hasAnchor">
<h2>Conceptual Review: Questions for Chapter 3<a href="linear-models.html#conceptual-review-questions-for-chapter-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-exploration-and-visualization.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["soa-exam-pa.pdf", "soa-exam-pa.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"theme": "journal",
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
